:root{
  /* Paleta REGISLAB – Azul oscuro + celestes */
  --bg:#020617;
  --card:#02081F;
  --card-2:#020617;
  --accent:#38BDF8;
  --accent-2:#0EA5E9;
  --text:#E5F4FF;
  --muted:#9CA3AF;
  --stroke:#1F2937;
  --shadow:0 8px 22px rgba(0,0,0,.45);
  --radius:14px;
  --topbar-h:64px;
}

/* ===== THEME LIGHT ===== */
html,body{height:100%}
html{scroll-padding-top:var(--topbar-h)}
*{box-sizing:border-box}

body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
  letter-spacing:.1px;
  color:var(--text);
  background:var(--bg);
}

body.theme-light{
  --bg:#f3f5f7;
  --card:#ffffff;
  --card-2:#e5f0ff;
  --text:#0f172a;
  --muted:#4b5563;
  --stroke:#d1d5db;
  --shadow:0 10px 26px rgba(15,23,42,.14);
}
body.theme-light .input{ background:#ffffff; color:#0f172a; }
body.theme-light .menu-item{ background:#ffffff; color:#111827; }
body.theme-light .menu-item:hover{ background:rgba(56,189,248,.10); }
body.theme-light .topbar{
  background:linear-gradient(180deg,#ffffff 0%, #e5f0ff 100%);
}
body.theme-light .sidebar{ background:var(--card-2); }
body.theme-light .panel-title{
  background:#ffffff;
  color:#0f172a;
}

/* ===== UTILIDADES BÁSICAS ===== */
.bg-app{background:var(--bg)}

.card{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:var(--radius);
  box-shadow:0 10px 26px rgba(0,0,0,.28);
  padding:14px;
}
body.theme-light .card{
  box-shadow:0 10px 26px rgba(0,0,0,.10);
}

.title{
  font-size:1.6rem;
  font-weight:800;
  color:#F9FAFB;
  margin:.25rem 0 1rem 0;
  text-align:center;
}
.subtitle{color:var(--muted)}
.center{text-align:center}
.mt-sm{margin-top:.75rem}
.mt-lg{margin-top:1.25rem}
.w-100{width:100%}

.tag{
  display:inline-block;
  padding:6px 10px;
  border:1px solid var(--stroke);
  border-radius:999px;
  color:var(--muted);
  background:var(--card-2);
}

/* ===== BOTONES ===== */
.btn{
  border:0;
  padding:12px 16px;
  border-radius:10px;
  cursor:pointer;
  font-weight:700;
}
.btn-primary{
  background:linear-gradient(180deg,var(--accent),var(--accent-2));
  color:#020617;
}
.btn-small{
  padding:6px 10px;
  border-radius:8px;
  font-weight:700;
  display:inline-flex;
  align-items:center;
  gap:6px;
  background:#ffffff;
  color:#020617;
  border:1px solid rgba(15,23,42,.22);
  box-shadow:0 6px 16px rgba(0,0,0,.18);
}
.btn-small:hover{
  border-color:var(--accent);
  box-shadow:0 8px 18px rgba(0,0,0,.22);
  filter:brightness(.99);
}
.btn-small:active{ transform:translateY(1px); }
.btn-small:focus{
  outline:2px solid rgba(56,189,248,.45);
  outline-offset:2px;
}

/* Variante blanca uniforme (Excel/PDF, topbar, etc.) */
.btn.btn-white{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:8px;
}
.btn-white{
  background:#ffffff;
  color:#020617;
  border:1px solid rgba(15,23,42,.18);
  box-shadow:0 6px 16px rgba(0,0,0,.18);
}
.btn-white:hover{ filter:brightness(.98); }
.btn-white:active{ transform:translateY(1px); }

/* Botones topbar un poco más sobrios */
.topbar .btn-small,
.topbar button.btn-small,
.topbar a.btn-small{
  background:#ffffff;
  color:#111827;
  border:1px solid #d1d5db;
  box-shadow:0 6px 16px rgba(0,0,0,.18);
}
.topbar .btn-small:hover{
  transform:translateY(-1px);
  box-shadow:0 10px 18px rgba(0,0,0,.22);
}

/* Badge Excel */
.excel-badge{
  display:inline-grid;
  place-items:center;
  width:18px;
  height:18px;
  border-radius:6px;
  background:linear-gradient(180deg,var(--accent),var(--accent-2));
  color:#020617;
  font-weight:900;
  font-size:12px;
}
.now-btn{padding:10px 12px; border-radius:10px}

/* ===== INPUTS ===== */
.input{
  background:#02081F;
  border:1px solid var(--stroke);
  color:#F9FAFB;
  padding:11px 12px;
  border-radius:10px;
  width:100%;
}
.input::placeholder{
  color:var(--muted);
}

/* tamaños específicos */
.input-qty{ width:120px; }
.input-date{ width:180px; }
.input-datetime{ width:230px; }

.label{color:var(--muted);margin-top:.25rem}

/* ===== LOGIN (si lo usas) ===== */
.login-wrapper{
  min-height:100vh;
  display:grid;
  place-items:center;
  padding:32px;
}
.login-card{
  width:min(380px,94vw);
  text-align:center;
}
.brand-mark{
  width:64px;
  height:auto;
  display:block;
  margin:0 auto 8px auto;
}

/* ========= ICONOS ========= */
.icon-img{
  width:18px;
  height:18px;
  display:block;
  flex-shrink:0;
}
.icon-img-sm{
  width:18px;
  height:18px;
  display:block;
  flex-shrink:0;
}

/* ========= TOPBAR ========= */
.topbar{
  position:fixed;
  top:0;
  left:0;
  right:0;
  z-index:50;
  background:linear-gradient(180deg,#02081F 0%, #020617 100%);
  border-bottom:1px solid var(--stroke);
  backdrop-filter:saturate(140%) blur(6px);
}
.topbar-inner{
  display:flex;
  align-items:center;
  gap:10px;
  padding:8px 14px;
}

/* grupos topbar */
.top-left{
  display:flex;
  align-items:center;
  gap:8px;
}
.top-center{
  flex:1;
  display:flex;
  justify-content:center;
  gap:8px;
  flex-wrap:wrap;
}
.top-right{
  display:flex;
  align-items:center;
  justify-content:flex-end;
}

/* logo */
.top-logo{
  width:40px;
  height:auto;
}
.top-brand{
  font-weight:800;
  color:var(--accent);
  letter-spacing:.6px;
}

/* compatibilidad */
.actions-right{
  margin-left:auto;
  display:inline-flex;
  gap:8px;
}

/* Topbar exportaciones completas mismo ancho */
.topbar .top-center .btn-small.export-full{
  min-width:240px;
  justify-content:center;
  white-space:nowrap;
}

/* ========= SIDEBAR ========= */
.sidebar{
  position:fixed;
  inset:var(--topbar-h) auto 0 0;
  width:310px;
  background:var(--card-2);
  border-right:1px solid var(--stroke);
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.sidebar-header{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:800;
  color:var(--accent);
}
.sidebar-header img{width:28px;height:auto}

.menu{
  display:flex;
  flex-direction:column;
  gap:8px;
}

/* ====== MENU SIDEBAR: versión “estable” (v7 azul) ====== */
.sidebar .menu-item,
.menu .menu-item{
  text-decoration:none !important;
  display:flex !important;
  flex-direction:row !important;
  align-items:center !important;
  justify-content:flex-start !important;
  gap:12px !important;

  flex-wrap:nowrap !important;
  white-space:nowrap !important;

  height:58px !important;
  padding:0 16px !important;

  border:1px solid var(--stroke) !important;
  border-radius:18px !important;
  box-sizing:border-box !important;

  background:#02081F;
  color:#F9FAFB;

  transform:none !important;
  will-change:auto !important;

  transition:
    background-color .16s ease,
    border-color .16s ease,
    box-shadow .16s ease,
    color .16s ease !important;
}

/* sin barras laterales */
.sidebar .menu-item::before,
.sidebar .menu-item::after,
.menu .menu-item::before,
.menu .menu-item::after{
  content:none !important;
  display:none !important;
}

/* iconos */
.sidebar .menu-item img,
.sidebar .menu-item svg,
.menu .menu-item img,
.menu .menu-item svg{
  width:22px !important;
  height:22px !important;
  flex:0 0 22px !important;
}

/* texto en una sola línea */
.sidebar .menu-item span,
.menu .menu-item span{
  flex:1 1 auto !important;
  min-width:0 !important;
  display:block !important;
  overflow:hidden !important;
  text-overflow:ellipsis !important;
  white-space:nowrap !important;
  line-height:1.1 !important;
}

/* hover: suave */
.sidebar .menu-item:hover,
.menu .menu-item:hover{
  transform:none !important;
  background-color:rgba(56,189,248,.10) !important;
  border-color:rgba(148,163,184,.9) !important;
}

/* active: azul */
.sidebar .menu-item.active,
.sidebar .menu-item[aria-current="page"],
.menu .menu-item.active,
.menu .menu-item[aria-current="page"]{
  background-color:rgba(56,189,248,.18) !important;
  border-color:rgba(56,189,248,.8) !important;
  box-shadow:0 0 0 1px rgba(56,189,248,.4) inset !important;
  color:#E5F4FF !important;
}
.sidebar .menu-item:active,
.menu .menu-item:active{
  box-shadow:0 0 0 2px rgba(56,189,248,.5) inset !important;
}

.sidebar-footer{
  margin-top:auto;
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* ========= CONTENIDO PRINCIPAL ========= */
.workspace{
  margin-left:310px;
  padding:18px;
  max-width:1100px;
  margin-top:calc(var(--topbar-h) + 12px);
}

.section{
  margin-bottom:18px;
  max-width:980px;
  margin-left:auto;
  margin-right:auto;
  scroll-margin-top:calc(var(--topbar-h) + 12px);
}

/* Mostrar solo la sección activa (navegación lateral) */
body.nav-single .section{ display:none; }
body.nav-single .section.is-active{ display:block; }
.panel-title{
  display:inline-block;
  margin:0 0 10px 0;
  padding:5px 11px;
  background:#02081F;
  border:2px solid var(--accent);
  color:#E5F4FF;
  border-radius:999px;
  box-shadow:var(--shadow);
  font-size:1.02rem;
}

/* ========= TABLAS ========= */
.table{
  width:100%;
  border-collapse:collapse;
  overflow:hidden;
  border-radius:12px;
}
.table thead th{
  background:var(--accent);
  color:#020617;
  padding:7px 8px;
  text-align:left;
}
.table tbody td{
  border-bottom:1px solid var(--stroke);
  padding:7px 8px;
}

/* tabla eventos supervisor */
.table-events{
  table-layout:fixed;
  width:100%;
}
.table-events th,
.table-events td{
  padding:8px 10px;
  font-size:13px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap !important;
  vertical-align:top;
}
.table-events th:nth-child(7),
.table-events td:nth-child(7){
  white-space:normal !important;
  overflow:visible;
  text-overflow:clip;
}

/* Tablas: permitir wrap en "Tipo" y celdas largas */
.table td{
  white-space:normal;
  word-break:break-word;
  overflow-wrap:anywhere;
}
.table th.col-tipo, .table td.col-tipo{ width:38%; }
.table th.col-detalle, .table td.col-detalle{ width:34%; }

/* Ajuste extra para Tipo */
.table td:nth-child(2), .table th:nth-child(2){ width:45%; }

/* ========= ROLES / READONLY ========= */
.only-supervisor{display:none}
.readonly .form input,
.readonly .form select,
.readonly .form textarea{
  pointer-events:none;
  opacity:.55;
}
.readonly .form button[type="submit"]{
  pointer-events:none;
  opacity:.55;
}
.role-operario .no-operario{ display:none !important; }

body.role-supervisor .only-supervisor{ display:block; }
body.role-supervisor .menu-item.only-supervisor{ display:flex; }
body.role-supervisor .btn-small.only-supervisor{ display:inline-flex; }
body.role-supervisor .tag.only-supervisor{ display:inline-flex; }

/* ========= FORMULARIOS TWO-COL ========= */
.form.two-col{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  align-items:flex-start;
}

/* Inputs por defecto en formularios */
.form.two-col .input{
  flex:1 1 300px;
  min-width:220px;
  padding:10px 12px;
}

/* Cantidad compacto */
.form.two-col .input-qty{
  flex:0 0 120px;
  min-width:120px;
}

/* Unidad ocupa resto de fila */
.form.two-col select.input{
  flex:1 1 260px;
  min-width:200px;
}

/* Fechas */
.form.two-col .input-date{
  flex:0 0 170px;
  min-width:170px;
}
.form.two-col .input-datetime{
  flex:0 0 230px;
  min-width:230px;
}

/* Acciones ocupan fila completa */
.form.two-col .actions-row{
  flex:1 1 100%;
  margin-top:4px;
}

/* Campos extra */
.form.two-col .input-detalle,
.form.two-col .input-cliente,
.form.two-col .input-razon{
  min-width:0;
}

/* Layout fecha + botón Ahora */
.input-unit{
  max-width:200px;
  justify-self:end;
}
.date-row{
  display:flex;
  align-items:center;
  gap:10px;
}
.date-row .input{
  flex:1 1 auto;
  min-width:0;
}
.date-row .now-btn{
  white-space:nowrap;
  padding:10px 14px;
}

/* ========= FILTROS ========= */
.card[data-filter-scope]{
  padding:12px;
}
.card[data-filter-scope] .tag{
  padding:5px 9px;
  font-size:.82rem;
}
.card[data-filter-scope] .actions-row{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  align-items:center;
}
.card[data-filter-scope] input[type="date"]{
  width:160px;
  flex:0 0 160px;
  padding:9px 10px;
}
.card[data-filter-scope] .input-search{
  width:220px;
  flex:0 0 220px;
  padding:9px 10px;
}
.card[data-filter-scope] .input-qty{
  width:90px;
  flex:0 0 90px;
  padding:9px 10px;
}
.card[data-filter-scope] .btn-small{
  padding:7px 10px;
}

/* ========= LAYOUT ACCIONES (Registrar / Exportar) ========= */
.actions-split{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  flex-wrap:nowrap;
}

/* Registrar (actions-right) a la izquierda visualmente */
.actions-right{
  order:1;
  display:flex;
  gap:10px;
  justify-content:flex-start;
  flex-wrap:nowrap;
}

/* Exportar (actions-left) a la derecha */
.actions-left{
  order:2;
  margin-left:auto;
  display:flex;
  gap:10px;
  justify-content:flex-end;
  flex-wrap:nowrap;
}

/* Botones homogéneos */
.actions-split .btn{
  min-width:auto;
  padding:10px 12px;
  font-size:.92rem;
  border-radius:10px;
  line-height:1;
}
.actions-split .btn .icon-img{
  width:16px;
  height:16px;
}
.actions-left .btn{
  padding:8px 10px;
  font-size:.86rem;
  border-radius:10px;
}

/* ========= TABLAS ESPECÍFICAS ========= */

/* Recepciones layout fijo */
table[data-table="recepciones"],
#stockTable,
#retirosTable{
  table-layout:fixed;
}

table[data-table="recepciones"] th:nth-child(1),
table[data-table="recepciones"] td:nth-child(1){ width:125px; }
table[data-table="recepciones"] th.col-tipo,
table[data-table="recepciones"] td.col-tipo{ width:56%; }
table[data-table="recepciones"] th.col-etiqueta,
table[data-table="recepciones"] td.col-etiqueta{ width:18%; }
table[data-table="recepciones"] th:nth-child(4),
table[data-table="recepciones"] td:nth-child(4){ width:95px; }
table[data-table="recepciones"] th:nth-child(5),
table[data-table="recepciones"] td:nth-child(5){ width:105px; }

#stockTable th.col-material,
#stockTable td.col-material{ width:50%; }
#stockTable th.col-etiqueta,
#stockTable td.col-etiqueta{ width:18%; }
#stockTable th.col-num,
#stockTable td.col-num{ width:95px; }
#stockTable th.col-date,
#stockTable td.col-date{ width:160px; }

#retirosTable th.col-date,
#retirosTable td.col-date{ width:170px; }
#retirosTable th.col-material,
#retirosTable td.col-material{ width:55%; }
#retirosTable th.col-num,
#retirosTable td.col-num{ width:95px; }

table[data-table="recepciones"] td.col-etiqueta,
#stockTable td.col-etiqueta{
  white-space:normal;
  overflow-wrap:anywhere;
  word-break:break-word;
}

/* Recepciones compactas */
#recepciones table[data-table="recepciones"] thead th{ padding:6px 8px; }
#recepciones table[data-table="recepciones"] tbody td{
  padding:5px 8px;
  font-size:13px;
  line-height:1.15;
}
#recepciones table[data-table="recepciones"] th:nth-child(2),
#recepciones table[data-table="recepciones"] td:nth-child(2){
  width:280px;
}
#recepciones table[data-table="recepciones"] th:nth-child(3),
#recepciones table[data-table="recepciones"] td:nth-child(3){
  width:160px;
}
#recepciones table[data-table="recepciones"] td:nth-child(2),
#recepciones table[data-table="recepciones"] td:nth-child(3){
  white-space:normal;
  word-break:break-word;
}

/* Maquinaria */
#maquinariaTable th:nth-child(2), #maquinariaTable td:nth-child(2){ width:120px; }
#maquinariaTable th:nth-child(4), #maquinariaTable td:nth-child(4){ width:auto; }
#maquinariaTable td:nth-child(4){ white-space:normal; word-break:break-word; }

/* Repuestos */
#repuestosTable th:nth-child(2), #repuestosTable td:nth-child(2){ width:150px; }
#repuestosTable th:nth-child(4), #repuestosTable td:nth-child(4){ width:auto; }
#repuestosTable td:nth-child(4){ white-space:normal; word-break:break-word; }
#repuestosTable th:nth-child(5), #repuestosTable td:nth-child(5){ width:140px; }

/* Stock: columna Estado */
#stockTable .col-status{ width:140px; }

/* ========= TOOLBARS / BADGES / PAGINACIÓN ========= */
.stock-toolbar{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  align-items:center;
}
.stock-toolbar .btn-small{
  height:34px;
  padding:8px 10px;
  white-space:nowrap;
}
.stock-toolbar .tag{ margin-left:auto; }
@media (max-width:920px){
  .stock-toolbar .tag{ margin-left:0; }
}
.stock-toolbar .btn-small.active{
  background:var(--accent);
  border-color:rgba(15,23,42,.18);
  color:#020617;
}

.status-badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:4px 10px;
  border-radius:999px;
  font-size:.85rem;
  font-weight:700;
  border:1px solid var(--stroke);
}
.status-badge.ok{
  background:rgba(34,197,94,.18);
  color:#bbf7d0;
}
.status-badge.bad{
  background:rgba(239,68,68,.18);
  color:#fecaca;
}

/* Paginación */
.pager{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:8px;
  margin-top:10px;
  user-select:none;
}
.pager .pager-info{
  color:var(--muted);
  font-size:.92rem;
}
.pager .btn-small{ padding:6px 10px; }

/* ========= MODAL ========= */
.modal-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  z-index:200;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:18px;
}
.modal-card{
  width:min(980px,96vw);
  max-height:86vh;
  overflow:auto;
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:16px;
  box-shadow:0 18px 48px rgba(0,0,0,.45);
  padding:14px;
}
.modal-header{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
  margin-bottom:10px;
}
.modal-title{
  font-size:1.05rem;
  font-weight:800;
}
.modal-subtitle{
  color:var(--muted);
  font-size:.92rem;
  margin-top:2px;
}
.modal-summary{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-bottom:10px;
}
.modal-body{ padding-top:6px; }

/* acciones en tabla dentro de modal */
.table td.actions-row{
  flex-wrap:wrap;
}

/* ========= MOBILE / DRAWER ========= */
.mobile-menu-btn{
  display:none;
  margin-right:10px;
  padding:8px 10px;
  height:36px;
  line-height:1;
}

.sidebar-overlay{
  display:none;
  position:fixed;
  top:var(--topbar-h);
  left:0;
  right:0;
  bottom:0;
  background:rgba(0,0,0,.55);
  z-index:48;
}

/* ========= RESPONSIVE ========= */
@media (max-width:920px){
  .workspace{
    margin-left:0 !important;
    padding:14px !important;
    max-width:100% !important;
    margin-top:calc(var(--topbar-h) + 12px);
  }

  .mobile-menu-btn{
    display:inline-flex;
    align-items:center;
    justify-content:center;
  }

  .topbar-inner{
    flex-wrap:wrap;
    gap:10px;
  }
  .top-center{
    width:100%;
    justify-content:flex-start;
    overflow-x:auto;
    -webkit-overflow-scrolling:touch;
    padding-bottom:4px;
  }
  .top-center .export-full{
    flex:0 0 auto;
    white-space:nowrap;
  }

  /* Sidebar como drawer */
  .sidebar{
    position:fixed !important;
    top:var(--topbar-h);
    left:0;
    height:calc(100dvh - var(--topbar-h));
    width:86vw;
    max-width:340px;
    z-index:49;
    transform:translateX(-105%);
    transition:transform .18s ease;
    border-right:1px solid var(--stroke);
    overflow:auto;
    -webkit-overflow-scrolling:touch;
    margin-top:0 !important;
  }
  body.sidebar-open .sidebar{ transform:translateX(0); }
  body.sidebar-open .sidebar-overlay{ display:block; }
  body.sidebar-open{ overflow:hidden; }

  .menu{
    flex-direction:column !important;
    flex-wrap:nowrap !important;
  }

  .table{
    display:block;
    width:100%;
    overflow-x:auto;
    -webkit-overflow-scrolling:touch;
  }
  .table thead th,
  .table tbody td{
    white-space:nowrap;
  }

  .btn-small{
    min-height:40px;
  }

  .form.two-col .input{
    flex:1 1 100%;
    min-width:0;
  }
  .form.two-col .input-qty{
    flex:1 1 45%;
    min-width:0;
  }
  .form.two-col select.input{
    flex:1 1 55%;
    min-width:0;
  }
  .card[data-filter-scope] input[type="date"]{
    flex:1 1 48%;
    width:auto;
  }
}

/* Ajuste extra pantallas muy pequeñas */
@media (max-width:520px){
  .top-left .brand-text{ display:none; }
}

/* Desktop: toolbar stock en una fila cuando se pueda */
@media (min-width:921px){
  .stock-toolbar{ flex-wrap:nowrap; }
}

/* Ajustes pequeñitos adicionales */
@media (max-width:720px){
  .actions-right,
  .actions-left{
    width:100%;
    margin-left:0;
  }
  .actions-left{
    flex-wrap:wrap;
    justify-content:flex-start;
  }
  .actions-split .btn{
    width:100%;
  }
}
